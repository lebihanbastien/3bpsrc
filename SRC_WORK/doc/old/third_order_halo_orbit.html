<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of third_order_halo_orbit</title>
  <meta name="keywords" content="third_order_halo_orbit">
  <meta name="description" content="--------------------------------------------------------------------------">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="index, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../index.html">Home</a> &gt;  <a href="index.html">old</a> &gt; third_order_halo_orbit.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../index.html"><img alt="<" border="0" src="../left.png">&nbsp;Master index</a></td>
<td align="right"><a href="index.html">Index for old&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>third_order_halo_orbit
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>--------------------------------------------------------------------------</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function yv_li =  third_order_halo_orbit(halo, t) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment">--------------------------------------------------------------------------
Init
--------------------------------------------------------------------------</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
<!-- crossreference -->



<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function yv_li =  third_order_halo_orbit(halo, t)</a>
0002 
0003 <span class="comment">%--------------------------------------------------------------------------</span>
0004 <span class="comment">%Init</span>
0005 <span class="comment">%--------------------------------------------------------------------------</span>
0006 yv_li = zeros(6,1);
0007 gamma_i = halo.li.gamma_i;
0008 mu = halo.cr3bp.mu;
0009 dm = halo.dm;
0010 
0011 <span class="comment">%Richardson coefficients</span>
0012 RC = richardson_coefficients(halo.cr3bp, halo.li.number);
0013 
0014 <span class="comment">%X and Z-amplitude in Li-frame</span>
0015 Az_li = halo.Az_estimate/gamma_i;
0016 Ax_li = sqrt(-(RC.l2*Az_li^2 + RC.Delta)/RC.l1);
0017 
0018 <span class="comment">%Phases</span>
0019 Phi = 0.0; <span class="comment">%arbitrary</span>
0020 
0021 <span class="comment">%nu parameter</span>
0022 nu = 1+RC.s1*Ax_li^2+RC.s2*Az_li^2;
0023 
0024 <span class="comment">%Third order estimate of the orbital period</span>
0025 <span class="comment">%double Tto = (2*M_PI)/(RC.omega_p*nu);</span>
0026 
0027 <span class="comment">%State estimate @ t  in the Li-frame</span>
0028 tau1 = RC.omega_p*nu*t + Phi;
0029 dtau1dt = RC.omega_p*nu;
0030 
0031 yv_li(1) = RC.a21*Ax_li^2 + RC.a22*Az_li^2 - Ax_li*cos(tau1) + (RC.a23*Ax_li^2 - RC.a24*Az_li^2)*cos(2*tau1) + (RC.a31*Ax_li^3 - RC.a32*Ax_li*Az_li^2)*cos(3*tau1);
0032 yv_li(2) = RC.kappa*Ax_li*sin(tau1) + (RC.b21*Ax_li^2 - RC.b22*Az_li^2)*sin(2*tau1) + (RC.b31*Ax_li^3 - RC.b32*Ax_li*Az_li^2)*sin(3*tau1);
0033 yv_li(3) = dm*Az_li*cos(tau1) + dm*RC.d21*Ax_li*Az_li*(cos(2*tau1)-3) + dm*(RC.d32*Az_li*Ax_li^2 - RC.d31*Az_li^3)*cos(3*tau1);
0034 
0035 yv_li(4) = dtau1dt*( Ax_li*sin(tau1) - 2*(RC.a23*Ax_li^2 - RC.a24*Az_li^2)*sin(2*tau1) -3*(RC.a31*Ax_li^3 - RC.a32*Ax_li*Az_li^2)*sin(3*tau1)  );
0036 yv_li(5) = dtau1dt*( RC.kappa*Ax_li*cos(tau1) + 2*(RC.b21*Ax_li^2 - RC.b22*Az_li^2)*cos(2*tau1) + 3*(RC.b31*Ax_li^3 - RC.b32*Ax_li*Az_li^2)*cos(3*tau1)   );
0037 yv_li(6) = dtau1dt*( -dm*Az_li*sin(tau1) -2*dm*RC.d21*Ax_li*Az_li*sin(2*tau1) - 3*dm*(RC.d32*Az_li*Ax_li^2 - RC.d31*Az_li^3)*sin(3*tau1)  );
0038 
0039 
0040 <span class="comment">%Back into COM frame</span>
0041 <span class="keyword">switch</span>(halo.li.number) <span class="comment">%special case of the x dimension</span>
0042 
0043     <span class="keyword">case</span> 1
0044         yv_li(1) = yv_li(1)*gamma_i - mu + 1 - gamma_i;
0045 
0046     <span class="keyword">case</span> 2
0047         yv_li(1) = yv_li(1)*gamma_i - mu + 1 + gamma_i;
0048 
0049     <span class="keyword">case</span> 3
0050         yv_li(1) = yv_li(1)*gamma_i - mu - gamma_i;
0051 
0052     <span class="keyword">otherwise</span> <span class="comment">%L2</span>
0053         yv_li(1) = yv_li(1)*gamma_i - mu + 1 + gamma_i;
0054 
0055 <span class="keyword">end</span>
0056 
0057 <span class="keyword">for</span> i = 2:6 
0058     yv_li(i) = gamma_i*yv_li(i); <span class="comment">%other dimensions</span>
0059 <span class="keyword">end</span>
0060         
0061         
0062 <span class="keyword">end</span></pre></div>
<hr><address>Generated on Sat 09-Apr-2016 16:20:23 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>